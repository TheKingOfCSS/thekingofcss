<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Mario 13</title>
	<link rel="shortcut icon" href="img/Mario.gif">
	<style>
		* { margin: 0; padding: 0; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; -webkit-box-sizing: border-box; box-sizing: border-box; }
		.game {
			height: 100vh;
			display: -webkit-box;
			display: -ms-flexbox;
			display: flex;
			-ms-flex-wrap: wrap;
			flex-wrap: wrap;
			-webkit-box-pack: center;
			-ms-flex-pack: center;
			justify-content: center;
			-ms-flex-line-pack: start;
			align-content: flex-start;
			position: relative;
			cursor: none;
			overflow: hidden;
			background: #000;
		}
		.game .Mario {
			position: absolute;
			top: 40%;
			left: 40%;
			width: 6%;
			height: 14vh;
			background: url(img/Mario.gif) no-repeat 3px 2px / 100% 14vh;
			pointer-events: none;
		}
		.game .princess {
			position: absolute;
			top: 3px;
			right: 10px;
			width: 80px;
			height: calc(100vh / 5);
			background: url(img/princess.gif) no-repeat center / cover;
			pointer-events: none;
		}
		.game .display {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			display: -webkit-box;
			display: -ms-flexbox;
			display: flex;
			-webkit-box-pack: center;
			-ms-flex-pack: center;
			justify-content: center;
			gap: 30px;
			z-index: 1;
			pointer-events: none;
			padding-top: 10px;
		}
		.game .display .gift {
			height: 70px;
			display: -webkit-box;
			display: -ms-flexbox;
			display: flex;
			-webkit-box-align: center;
			-ms-flex-align: center;
			align-items: center;
			-webkit-box-shadow: inset 0 0 10px #fff, 0 3px 15px #0005;
			box-shadow: inset 0 0 10px #fff, 0 3px 15px #0005;
			background: #fff6;
			border-radius: 50px;
			padding: 10px 20px;
			-webkit-transition: .5s;
			transition: .5s;
			translate: 0 -100px;
		}
		.game .display .gift p {
			color: #fff;
			font: 24px verdana;
			margin: 0 10px;
			text-shadow: 0 0 5px #000, 0 0 12px #0005;
		}
		.game .display .gift img {
			height: 100%;
		}
		.game .time {
			position: absolute;
			top: 50%;
			left: -100px;
			translate: 0 -50%;
			border-radius: 0 50% 50% 0;
			background: #0009;
			padding: 8px 15px 8px 8px;
			font: 28px sans-serif;
			color: #fff;
			-webkit-box-shadow: 0 0 5px #000;
			box-shadow: 0 0 5px #000;
			z-index: 1;
			pointer-events: none;
			-webkit-transition: .5s;
			transition: .5s;
		}
		.game .MarioLife {
			position: absolute;
			top: 0;
			left: -100px;
			padding: 5px 10px 5px 5px;
			pointer-events: none;
			display: -webkit-box;
			display: -ms-flexbox;
			display: flex;
			-webkit-box-align: center;
			-ms-flex-align: center;
			align-items: center;
			-webkit-column-gap: 5px;
			column-gap: 5px;
			-webkit-box-shadow: inset 0 0 10px #fff, 0 0 10px #0009;
			box-shadow: inset 0 0 10px #fff, 0 0 10px #0009;
			z-index: 1;
			border-bottom-right-radius: 50%;
			-webkit-transition: .5s;
			transition: .5s;
		}
		.game .MarioLife img {
			height: 55px;
		}
		.game .MarioLife span {
			color: #fff;
			font: bold 25px verdana;
			text-shadow: 0 0 3px #000, 0 -2px 4px #0006;
		}
		.game .gameOver {
			position: absolute;
			top: 50%;
			left: 50%;
			translate: -50% -50%;
			z-index: 10;
			font: bold 6vw verdana;
			color: #f00;
			text-shadow: -3px 5px 6px #000, 0 -4px 2px #fff;
			letter-spacing: 50vw;
			scale: 0;
			-webkit-transition: 1s;
			transition: 1s;
		}
		@-webkit-keyframes true {
			50% { -webkit-box-shadow: inset 0 0 10px #fff, 0 3px 15px #0005, 0 0 20px 5px #fff; box-shadow: inset 0 0 10px #fff, 0 3px 15px #0005, 0 0 20px 5px #fff; }
		}
		@keyframes true {
			50% { -webkit-box-shadow: inset 0 0 10px #fff, 0 3px 15px #0005, 0 0 20px 5px #fff; box-shadow: inset 0 0 10px #fff, 0 3px 15px #0005, 0 0 20px 5px #fff; }
		}
		@-webkit-keyframes Mario {
			from, to { -webkit-filter: sepia(1) saturate(1.8); filter: sepia(1) saturate(1.8); }
			50% { -webkit-filter: sepia(1) saturate(3.8) brightness(1.3); filter: sepia(1) saturate(3.8) brightness(1.3); }
		}
		@keyframes Mario {
			from, to { -webkit-filter: sepia(1) saturate(1.8); filter: sepia(1) saturate(1.8); }
			50% { -webkit-filter: sepia(1) saturate(3.8) brightness(1.3); filter: sepia(1) saturate(3.8) brightness(1.3); }
		}
		.menu {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: url(img/menu.jpg) no-repeat 15vw 50% / 100% #B6121B;
			z-index: 10;
			text-align: center;
			padding-top: 5%;
			-webkit-transition: .7s;
			transition: .7s;
			-webkit-clip-path: circle(100%);
			clip-path: circle(100%);
			-webkit-animation: menu 6s linear infinite;
			animation: menu 6s linear infinite;
		}
		@-webkit-keyframes menu {
			50% { background-size: 105%; }
		}
		@keyframes menu {
			50% { background-size: 105%; }
		}
		.menu h1 {
			font: bold 10vw verdana;
			color: #fff;
			-webkit-animation: title 1.2s infinite;
			animation: title 1.2s infinite;
			text-shadow: 0 4px 15px #fff;
		}
		.menu .play {
			background: #fff;
			display: inline-block;
			font: bold 4vw verdana;
			padding: 2vw 4vw;
			border-radius: 6vw;
			margin-top: 7vw;
			cursor: pointer;
			-webkit-transition: .3s;
			transition: .3s;
		}
		.menu .play:hover {
			-webkit-box-shadow: inset 0 -.8vw 0 #087938, inset 0 .8vw 0 #222;
			box-shadow: inset 0 -.8vw 0 #087938, inset 0 .8vw 0 #222;
		}
		.menu .play:active {
			-webkit-box-shadow: inset 0 .8vw 0 #087938, inset 0 -.8vw 0 #222;
			box-shadow: inset 0 .8vw 0 #087938, inset 0 -.8vw 0 #222;
		}
		@-webkit-keyframes title {
			50% { letter-spacing: 20px; }
		}
		@keyframes title {
			50% { letter-spacing: 20px; }
		}
		.menu .author {
			position: absolute;
			bottom: 0;
			left: 0;
			width: 100%;
			font: bold 18px/1.2 system-ui, verdana;
			color: #fff;
			background: #111;
			padding: 7px 0 8px;
			letter-spacing: 1px;
		}
	</style>
</head>
<body>
	<div class="game">
		<div class="Mario"></div>
		<div class="princess"></div>
		<div class="MarioLife">
			<img src="img/face.png" alt="Img">
			<span>3</span>
		</div>
		<div class="display">
			<div class="gift">
				<img src="img/ring1.png" alt="Img">
				<p><span>0</span> / <span>5</span></p>
			</div>
			<div class="gift">
				<img src="img/ring2.webp" alt="Img">
				<p><span>0</span> / <span>4</span></p>
			</div>
			<div class="gift">
				<img src="img/gift2.webp" alt="Img">
				<p><span>0</span> / <span>10</span></p>
			</div>
		</div>
		<div class="time"><span>5</span>sec</div>
		<h2 class="gameOver">GameOver</h2>
	</div>
	<div class="menu">
		<h1>Mario 13</h1>
		<div class="play">Play</div>
		<p class="author">
			Instructor Hovo Vardanyan
			<br>
			&copy; Copyright All Right Reserved 2023
		</p>
	</div>
	<script>
		const game = document.querySelector('.game');
		const Mario = document.querySelector('.game .Mario');
		const gift = document.querySelectorAll('.game .display .gift');
		const disInfo = document.querySelectorAll('.game .display .gift p');
		const disTime = document.querySelector('.game .time span');
		const MarioLife = document.querySelector('.game .MarioLife span');
		const gameOver = document.querySelector('.game .gameOver');
		const gamePlay = document.querySelector('.menu .play');
		const asyncControl = time => new Promise(res => setTimeout(res, time));
		const theme = new Audio('img/theme.mp3');
		const star = new Audio('img/star.mp3');
		const kick = new Audio('img/kick.mp3');
		const winner = new Audio('img/win.mp3');
		const coin = new Audio('img/coin.mp3');
		const level = new Audio('img/level.mp3');
		const bad = new Audio('img/bad.mp3');
		const princess = new Audio('img/princess.mp3');
		const yes = new Audio('img/yes.mp3');
		const gameOverSound = new Audio('img/gameOver.mp3');
		theme.volume = .6;
		theme.onended = () => theme.play();
		const data = [
			['img/ring1.png', 'ring1'],
			['img/ring2.webp', 'ring2'],
			['img/gift2.webp', 'gift2'],
			['img/gift1.png', 'gift1'],
			['img/mush1.webp', 'mush1']
		];
		gamePlay.onclick = async () => {
			theme.play();
			gamePlay.style.pointerEvents = 'none';
			gamePlay.parentElement.style.clipPath = 'circle(0 at 85%)';
			await asyncControl(5e2);
			gamePlay.parentElement.style.animation = 'none';
			gamePlay.previousElementSibling.style.animation = 'none';
		};
		const chords = [5, 4, 10, 6, 25];
		const data2 = [];
		for (let i = 0; i < chords.length; i++) {
			data2.push([]);
			for (let j = 0; j < chords[i]; j++) {
				let rand = Math.floor(Math.random() * 50);
				while(data2.some(item => item.some(item => item == rand))) rand = Math.floor(Math.random() * 50);
				data2[i].push(rand);
			}
		}
		data2.forEach((item, index) => (item.some((item, ind) => item == 9 ? data2[index][ind] = 'Mario' : ''), item.forEach((item, ind) => item == 'Mario' ? index == 0 || index == 1 || index == 2 ? disInfo[index].lastElementChild.innerText-- : '' : '')));
		let x = game.offsetWidth / 2;
		let ring1 = 0;
		let c = Math.floor(Math.random() * 2);
		let sec = 5;
		let superMario = false;
		let gameTrue = true;
		for (let i = 0; i < 50; i++) {
			const box = document.createElement('div');
			game.appendChild(box);
			box.className = 'box';
			let r = Math.random() * (255 - 30) + 20;
			let g = Math.random() * (255 - 30) + 20;
			box.style = `width: calc(100% / 10); height: calc(100vh / 5); box-shadow: inset 0 0 10px 10px #0005; transition: .3s; display: flex; justify-content: center; align-items: center;`;
			i == 9 ? (box.style.background = '#5df8ff', box.style.boxShadow = 'inset 0 -20px 9px 14px #00000054, inset 0 15px 20px 16px #00b4ffb3') : '';
			box.style.background = c == 0 ? `rgb(${r}, ${g}, ${g})` : `rgb(${r}, ${r}, ${g})`;
			box.onmouseover = () => i != 9 ? box.style.boxShadow = 'inset 0 0 20px 10px #000' : '';
			box.onmouseleave = () => box.style.boxShadow = 'inset 0 0 10px 10px #0005';	
			if (i != 9) {
				box.onclick = async () => {
					kick.currentTime = 0;
					kick.play();
					gift.forEach(async (item, index) => {
						if (index == box.firstElementChild.dataset.index) {
							box.firstElementChild.dataset.name == 'gift2' ? (coin.currentTime = 0, coin.play()) : (level.currentTime = 0, level.play());
							item.style.translate = 0;
							await asyncControl(65e1);
							disInfo[index].firstElementChild.innerText++;
							disInfo[index].parentElement.style.animation = 'true .2s infinite';
							await asyncControl(3e2);
							item.style.translate = null;
							disInfo[index].parentElement.style.animation = null;
							if (disInfo[0].lastElementChild.innerText == disInfo[0].firstElementChild.innerText && disInfo[1].lastElementChild.innerText == disInfo[1].firstElementChild.innerText && disInfo[2].lastElementChild.innerText == disInfo[2].firstElementChild.innerText) {
								winner.play();
								theme.pause();
								yes.play();
								gameOver.innerHTML = 'Mario<br>You Win';
								gameOver.style = 'scale: 1.5; letter-spacing: 0; color: #0f0; text-align: center; white-space: nowrap;';
								await asyncControl(6e3);
								location['reload']();
							}
						}
					});
					box.style.pointerEvents = 'none';
					box.style.opacity = .1;
					let time;
					if (box.firstElementChild.dataset.name == 'gift1') {
						star.play();
						theme.pause();
						disTime.parentElement.style.left = 0;
						Mario.style.animation = 'Mario .2s infinite';
						superMario = true;
						clearInterval(1);
						clearInterval(2);
						clearInterval(3);
						clearInterval(4);
						clearInterval(5);
						clearInterval(6);
						sec = 5;
						disTime.innerText = sec;
						time = setInterval(() => {
							sec--;
							sec == 0 ? (clearInterval(time), Mario.style.animation = null, disTime.parentElement.style.left = null, superMario = false, theme.play(), star.pause()) : '';
							disTime.innerText = sec;
						}, 1e3);
					} else if (box.firstElementChild.dataset.name == 'mush1' && !superMario) {
						theme.pause();
						(async function() {
							bad.currentTime = 0;
							bad.play();
							princess.play();
							MarioLife.parentElement.style.left = 0;
							await asyncControl(5e2);
							gift.forEach(async item => {
								item.style.translate = 0;
								await asyncControl(8e2);
								item.lastElementChild.firstElementChild.innerText = 0;
								game.querySelectorAll('.box').forEach(item => {
									item.style.pointerEvents = null;
									item.style.opacity = null;
								});
							});
							await asyncControl(12e2);
							MarioLife.innerText--;
							if (MarioLife.innerText == 0) {
								gameTrue = false;
								gameOverSound.play();
								game.querySelectorAll('.box').forEach(item => {
									item.style.pointerEvents = 'none';
									item.style.background = '#222';
									item.style.filter = 'grayscale(1)';
								});
								Mario.style.zIndex = 1;
								gameOver.style = 'scale: 1; letter-spacing: 0;';
								await asyncControl(3e3);
								location['reload']();
							}
							await asyncControl(2e2);
							gift.forEach(async item => item.style.translate = null);
							await asyncControl(4e2);
							gameTrue ? theme.play() : '';
							MarioLife.parentElement.style.left = null;
						})();
					}
				};
			}
			box.onmouseenter = () => {
				if (i == 9) {
					let set = setInterval(() => {
						const heart = document.createElement('div');
						heart.style = `position: absolute; top: ${Mario.offsetTop}px; left: ${Mario.offsetLeft + 20}px; width: 20px; height: 20px; background: url(img/heart.gif) no-repeat center / cover; transition: .5s;`;
						game.appendChild(heart);
						heart.className = 'heart';
						setTimeout(() => {
							heart.style.top = '-30px';
							heart.style.width = '50px';
							heart.style.height = '50px';
						}, 20);
					}, 100);
					box.onmouseleave = () => {
						clearInterval(set);
						document.querySelectorAll('.game .heart').forEach(item => item.style.top = '-100px');
						setTimeout(() => document.querySelectorAll('.game .heart').forEach(item => item.remove()), 5e2);
					};
				}
			};
		}
		const box = document.querySelectorAll('.game .box');
		data2.forEach((item, index) => {
			item.forEach(item2 => {
				if (item2 != 'Mario') {
					const img = document.createElement('img');
					box[item2].appendChild(img);
					img.style = 'width: 40%; filter: drop-shadow(0 0 20px #fff);';
					img.src = data[index][0];
					img.dataset.name = data[index][1];
					img.dataset.index = index;
				}
			});
		});
		document.onmousemove = e => {
			Mario.style.top = e.y - Mario.offsetHeight / 2.3 + 'px';	
			Mario.style.left = e.x - Mario.offsetWidth / 2.3 + 'px';
			Mario.offsetTop < 0 ? Mario.style.top = 0 : '';
			Mario.offsetTop + Mario.offsetHeight > game.offsetHeight ? Mario.style.top = game.offsetHeight - Mario.offsetHeight + 10 + 'px' : '';
			Mario.style.scale = e.x < x ? null : '-1 1';
			x = e.x;
		};
		document.oncontextmenu = () => false;
		document.addEventListener('keydown', e => e.ctrlKey || e.which == 123 ? e.preventDefault() : '');
		console['log']('%cBy The King Of CSS', 'color: #000000; font: bold 2rem sans-serif; text-shadow: 0 3px 3px #fff, -4px 7px 7px #000; padding: 20px;');
	</script>
</body>
</html>